{{ config(materialized="view") }}
select
    _id as id,
    civilian_casualties,
    count_of_persons_rescued,
    (civilian_casualties + count_of_persons_rescued) as people_impacted,
    estimated_number_of_persons_displaced,
    estimated_dollar_loss,
    incident_ward,
    possible_cause,
    area_of_origin,
    building_status,
    business_impact,
    exposures,
    ext_agent_app_or_defer_time,
    extent_of_fire,
    final_incident_type,
    fire_alarm_system_impact_on_evacuation,
    fire_alarm_system_operation,
    fire_alarm_system_presence,
    fire_under_control_time,
    ignition_source,
    incident_number,
    incident_station_area,
    initial_cad_event_type,
    intersection,
    last_tfs_unit_clear_time,
    latitude,
    longitude,
    level_of_origin,
    material_first_ignited,
    method_of_fire_control,
    number_of_responding_apparatus,
    number_of_responding_personnel,
    property_use,
    smoke_alarm_at_fire_origin,
    smoke_alarm_at_fire_origin_alarm_failure,
    smoke_alarm_at_fire_origin_alarm_type,
    smoke_alarm_impact_on_persons_evacuating_impact_on_evacuation,
    smoke_spread,
    sprinkler_system_operation,
    sprinkler_system_presence,
    status_of_fire_on_arrival,
    tfs_alarm_time,
    tfs_arrival_time,
    tfs_firefighter_casualties

from {{ ref("fire_data") }}
